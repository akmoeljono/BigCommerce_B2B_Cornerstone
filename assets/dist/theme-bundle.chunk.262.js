"use strict";(self.webpackChunkbigcommerce_cornerstone=self.webpackChunkbigcommerce_cornerstone||[]).push([[262],{35262:function(n,t,e){e.d(t,{Z:function(){return y}}),e(35666);var r=e(42066),a=e(55825);function i(n,t,e,r,a,i,u){try{var o=n[i](u),s=o.value}catch(n){return void e(n)}o.done?t(s):Promise.resolve(s).then(r,a)}function u(n){return function(){var t=this,e=arguments;return new Promise((function(r,a){var u=n.apply(t,e);function o(n){i(u,r,a,o,s,"next",n)}function s(n){i(u,r,a,o,s,"throw",n)}o(void 0)}))}}var o=function(){var n=u(regeneratorRuntime.mark((function n(t){var e,r,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e={method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+bearerToken},body:JSON.stringify({query:t})},n.prev=1,n.next=4,fetch("/graphql",e);case 4:return r=n.sent,n.next=7,r.json();case 7:if((a=n.sent)&&a.data){n.next=10;break}throw new Error("Invalid GraphQL response");case 10:return n.abrupt("return",a.data);case 13:throw n.prev=13,n.t0=n.catch(1),console.error("GraphQL error:",n.t0),n.t0;case 17:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(t){return n.apply(this,arguments)}}(),s=function(){var n=u(regeneratorRuntime.mark((function n(t){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e="query ExtendedProductsById{\n                   site {\n                     products(entityIds: ["+t.join(",")+"], first: 50) {\n                    edges {\n                        node {\n                          name\n                          inventory {\n                            isInStock\n                          }\n                          customFields {\n                            edges {\n                              node {\n                                name\n                                value\n                              }\n                            }\n                          }\n                          variants {\n                            edges {\n                              node {\n                                prices {\n                                  basePrice {\n                                    value\n                                  }\n                                }\n                                id\n                                entityId\n                                sku\n                                isPurchasable\n                                inventory {\n                                  isInStock\n                                }\n                                options {\n                                  edges {\n                                    node {\n                                      displayName\n                                      entityId\n                                      values {\n                                        edges {\n                                          node {\n                                            entityId\n                                            label\n                                          }\n                                        }\n                                      }\n                                    }\n                                  }\n                                }\n                              }\n                            }\n                          }\n                          entityId\n                        }\n                      }\n                     }\n                   }\n                 }",n.abrupt("return",o(e));case 2:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),c=function(n){var t,e,r=n.variants.edges.map((function(n){var t,e,r=n.node,a=null==(t=r.options.edges[0])?void 0:t.node,i=(null==a||null==(e=a.values.edges[0])?void 0:e.node.label)||null;return a?{sku:r.sku,stock:r.inventory.isInStock,optionDisplayName:(null==a?void 0:a.displayName)||"",optionEntityId:(null==a?void 0:a.entityId)||null,price:r.prices.basePrice.value,optionValue:i}:null})),a=null==n||null==(t=n.customFields)?void 0:t.edges.map((function(n){return{name:n.node.name,value:n.node.value}})).find((function(n){return"B2Boptions"===n.name})),i=null==n||null==(e=n.customFields)?void 0:e.edges.map((function(n){return{name:n.node.name,value:n.node.value}})).find((function(n){return"QtyPerUnit"===n.name}));return{entityId:n.entityId,variants:null===r[0]?[]:r,B2BCustomField:a||null,QtyPerUnitCustomField:i||null,isInStock:n.inventory.isInStock}},d=function(){var n=u(regeneratorRuntime.mark((function n(t){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s(t);case 2:return e=n.sent,n.abrupt("return",e.site.products.edges.map((function(n){var t=n.node;return c(t)})));case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),l=function(){return new Promise((function(n,t){r.ZP.api.cart.getCart({},(function(e,r){e?t(e):n(r)}))}))},p=function(n){var t=n?n.lineItems.physicalItems.reduce((function(n,t){return n+t.quantity}),0):0;a("body").trigger("cart-quantity-update",t),t||a(".navUser-item--cart").removeClass("show")},f=function(n,t){fetch("/cart.php?action=add&sku="+n+"&qty="+t).then(function(){var n=u(regeneratorRuntime.mark((function n(t){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ok){n.next=2;break}throw new Error("Failed to add product to cart. Status: "+t.status);case 2:return n.t0=p,n.next=5,l();case 5:n.t1=n.sent,(0,n.t0)(n.t1);case 7:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){console.error("Error adding product to cart:",n)}))},v=function(){var n=u(regeneratorRuntime.mark((function n(t){var e,i,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.val(),i=t.data("sku"),n.next=4,l();case 4:if(o=n.sent){n.next=9;break}return f(i,e),a(".navUser-item--cart").addClass("show"),n.abrupt("return");case 9:if(s=o.lineItems.physicalItems.find((function(n){return n.sku===i}))){n.next=13;break}return f(i,e),n.abrupt("return");case 13:c=s.id,d=e,r.ZP.api.cart.itemUpdate(c,d,u(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=p,n.next=3,l();case 3:n.t1=n.sent,(0,n.t0)(n.t1);case 5:case"end":return n.stop()}}),n)}))));case 14:case"end":return n.stop()}var c,d}),n)})));return function(t){return n.apply(this,arguments)}}(),m=function(n,t){var e,r=a("#qty-"+n),i=a('[data-sku="'+n+'"]');if((e=r).find("button").on("click",(function(n){var t=+e.find("input").val()+(a(n.target).hasClass("dec")?-1:1),r=e.find("input");r.val(t>0?t:0),v(r)})),function(n){n.on("change",(function(){var n=parseInt(a(this).val(),10);n=Math.min(1e3,Math.max(0,n)),a(this).val(n),v(a(this))}))}(i),t){var u=t.lineItems.physicalItems.find((function(t){return t.sku===n}));u&&i.val(u.quantity)}},h=function(){var n=u(regeneratorRuntime.mark((function n(t){var e,r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d(t);case 2:return e=n.sent,r=a("li.product"),n.next=6,l();case 6:i=n.sent,r.each((function(){var n,t=this,r=e.filter((function(n){return n.entityId===a(t).data("id")}))[0];null!=r&&r.isInStock?null!=r&&null!=(n=r.variants)&&n.length&&r.variants.filter((function(n){return r.B2BCustomField.value.split(",").includes(n.optionValue)})).forEach((function(n){var e,r;a(t).find(".custom-add-to-cart").append((e=n.optionValue,'\n        <div id="qty-'+(r=n.sku)+'" style="margin: auto">\n            <p>'+e+'</p>\n            <div class="input-box">\n                <button class="dec"></button>\n                 <input type="number" value="0" min="0" max="1000" data-sku="'+r+'">\n                 <button class="inc"></button>\n            </div>\n        </div>\n    ')),m(n.sku,i)})):a(this).find(".custom-add-to-cart").append('\n    <div class="alertBox productAttributes-message">\n        <div class="alertBox-column alertBox-icon">\n            <icon glyph="ic-success" class="icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></svg></icon>\n        </div>\n        <p class="alertBox-column alertBox-message">Out of Stock</p>\n    </div>\n')}));case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),g=function(){var n=u(regeneratorRuntime.mark((function n(t){var e,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("pages/product"!==t.template&&t.customer){n.next=3;break}return n.abrupt("return");case 3:return e=a("li.product").toArray(),r=e.map((function(n){return a(n).data("id")})),n.next=7,h(r);case 7:i=void 0,i=a("#product-listing-container"),a(".container .isCategoryPage .page-sidebar").css("max-height",i.height()+"px");case 8:case"end":return n.stop()}var i}),n)})));return function(t){return n.apply(this,arguments)}}(),y=g}}]);
//# sourceMappingURL=theme-bundle.chunk.262.js.map
